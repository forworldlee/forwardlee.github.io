<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>不忘初心</title>
  <subtitle>李奉华的个人博客</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.forwardlee.com/"/>
  <updated>2017-08-01T08:21:26.000Z</updated>
  <id>http://www.forwardlee.com/</id>
  
  <author>
    <name>ForwardLee</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Laravel 5.x进阶笔记（二）</title>
    <link href="http://www.forwardlee.com/2017/08/01/p/Laravel5.x%E8%BF%9B%E9%98%B6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <id>http://www.forwardlee.com/2017/08/01/p/Laravel5.x进阶笔记（二）/</id>
    <published>2017-08-01T07:54:53.000Z</published>
    <updated>2017-08-01T08:21:26.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="在浏览器中展示创建的Article列表"><a href="#在浏览器中展示创建的Article列表" class="headerlink" title="在浏览器中展示创建的Article列表"></a>在浏览器中展示创建的Article列表</h2><p>在浏览器中展示创建的Article数据，需要使用Http请求Web服务器，Web服务器接收请求并将Article数据在视图页面中展示，即MVC。完成上述操作，离不开Laravel的路由功能，所谓路由就是请求的控制转发。Laravel把所有的请求地址预先配置在路由列表文件中learnlaravel5/app/Http/routes.php。描述路由的基本格式是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Route::get(&apos;/home&apos;, &apos;HomeController@index&apos;);</div></pre></td></tr></table></figure>
<p>Route类（\Illuminate\Support\Facades\Route）是Laravel框架提供的路由配置工具类，get标识http请求的Method（get/post/put/patch…），get函数的第一个参数是url格式定义，第二个参数用@分割成两部分，第一部分是Http请求的Controller类，第二部分标识Controller的具体执行方法，具体看HomeController类的内容描述：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line"></div><div class="line">namespace App\Http\Controllers;</div><div class="line"></div><div class="line">use App\Article;</div><div class="line">use App\Http\Requests;</div><div class="line">use Illuminate\Http\Request;</div><div class="line"></div><div class="line">class HomeController extends \Illuminate\Routing\Controller</div><div class="line">&#123;</div><div class="line">    /**</div><div class="line">     * Create a new controller instance.</div><div class="line">     *</div><div class="line">     * @return void</div><div class="line">     */</div><div class="line">    public function __construct()</div><div class="line">    &#123;</div><div class="line">        $this-&gt;middleware(&apos;auth&apos;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * Show the application dashboard.</div><div class="line">     *</div><div class="line">     * @return \Illuminate\Http\Response</div><div class="line">     */</div><div class="line">    public function index()</div><div class="line">    &#123;</div><div class="line">        return view(&apos;home&apos;)-&gt;withArticles(Article::all());;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>_construct()是默认构造函数，函数体使用middleware(‘auth’)中间件，描述访问这个Controller需要登录验证。index()方法则是在路由中指定的执行方法，返回值是一个视图层对象view，视图的目录位置是模板文件learnlaravel5/resources/views/home.blade.php，view(‘home’)中的home与模板文件的第一个关键字相同，index函数指定了返回的视图文件，并把Article数据通过Eloquent方法取出，使用withArticles方法携带返回到视图页面，此处withArticles标识在页面可以通过articles对象取得所有返回的数据，依次类推如果是withAcls,则在页面上使用acls对象获取返回的数据。home.blade.php示例（php模板语法自行解决）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">@extends(&apos;layouts.app&apos;)</div><div class="line"></div><div class="line">@section(&apos;content&apos;)</div><div class="line">    &lt;div id=&quot;title&quot; style=&quot;text-align: center;&quot;&gt;</div><div class="line">        &lt;h1&gt;Learn Laravel 5&lt;/h1&gt;</div><div class="line">        &lt;div style=&quot;padding: 5px; font-size: 16px;&quot;&gt;Learn Laravel 5&lt;/div&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">    &lt;hr&gt;</div><div class="line">    &lt;div id=&quot;content&quot;&gt;</div><div class="line">        &lt;ul&gt;</div><div class="line">            @foreach ($articles as $article)</div><div class="line">                &lt;li style=&quot;margin: 50px 0;&quot;&gt;</div><div class="line">                    &lt;div class=&quot;title&quot;&gt;</div><div class="line">                        &lt;a href=&quot;&#123;&#123; url(&apos;article/&apos;.$article-&gt;id) &#125;&#125;&quot;&gt;</div><div class="line">                            &lt;h4&gt;&#123;&#123; $article-&gt;title &#125;&#125;&lt;/h4&gt;</div><div class="line">                        &lt;/a&gt;</div><div class="line">                    &lt;/div&gt;</div><div class="line">                    &lt;div class=&quot;body&quot;&gt;</div><div class="line">                        &lt;p&gt;&#123;&#123; $article-&gt;body &#125;&#125;&lt;/p&gt;</div><div class="line">                    &lt;/div&gt;</div><div class="line">                &lt;/li&gt;</div><div class="line">            @endforeach</div><div class="line">        &lt;/ul&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">@endsection</div></pre></td></tr></table></figure>
<p>通过浏览器输入<a href="http://localhost:1024/home，就能看到数据加载到页面。" target="_blank" rel="external">http://localhost:1024/home，就能看到数据加载到页面。</a><br><img src="/images/home_articles.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;在浏览器中展示创建的Article列表&quot;&gt;&lt;a href=&quot;#在浏览器中展示创建的Article列表&quot; class=&quot;headerlink&quot; title=&quot;在浏览器中展示创建的Article列表&quot;&gt;&lt;/a&gt;在浏览器中展示创建的Article列表&lt;/h2&gt;&lt;p&gt;在浏
    
    </summary>
    
    
      <category term="PHP" scheme="http://www.forwardlee.com/tags/PHP/"/>
    
      <category term="Laravel5" scheme="http://www.forwardlee.com/tags/Laravel5/"/>
    
  </entry>
  
  <entry>
    <title>Laravel 5.x进阶笔记（二）</title>
    <link href="http://www.forwardlee.com/2017/08/01/p/Laravel5.x%E8%BF%9B%E9%98%B6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/"/>
    <id>http://www.forwardlee.com/2017/08/01/p/Laravel5.x进阶笔记（三）/</id>
    <published>2017-08-01T06:42:53.000Z</published>
    <updated>2017-08-01T08:21:34.000Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
      <category term="PHP" scheme="http://www.forwardlee.com/tags/PHP/"/>
    
      <category term="Laravel5" scheme="http://www.forwardlee.com/tags/Laravel5/"/>
    
  </entry>
  
  <entry>
    <title>Laravel 5.x进阶笔记（一）</title>
    <link href="http://www.forwardlee.com/2017/08/01/p/Laravel5.x%E8%BF%9B%E9%98%B6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <id>http://www.forwardlee.com/2017/08/01/p/Laravel5.x进阶笔记（一）/</id>
    <published>2017-08-01T06:42:53.000Z</published>
    <updated>2017-08-01T08:28:46.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="默认条件"><a href="#默认条件" class="headerlink" title="默认条件"></a>默认条件</h2><p>MacOS，&gt;=PHP5.4，翻墙环境（默认创建的项目会请求*.google.com）<br>懂得PHP基础知识和MVC的基本架构，开发环境已经安装Laravel所需的命令环境。</p>
<h2 id="配置composer中国镜像，使得本地开发环境下载依赖速度更快。"><a href="#配置composer中国镜像，使得本地开发环境下载依赖速度更快。" class="headerlink" title="配置composer中国镜像，使得本地开发环境下载依赖速度更快。"></a>配置composer中国镜像，使得本地开发环境下载依赖速度更快。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">composer config -g repo.packagist composer https://packagist.phpcomposer.com</div></pre></td></tr></table></figure>
<h2 id="创建Laravel项目"><a href="#创建Laravel项目" class="headerlink" title="创建Laravel项目"></a>创建Laravel项目</h2><p>进入项目的工作空间目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cd ~/workspace</div></pre></td></tr></table></figure>
<p>创建Laravel项目<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">composer -vvv create-project laravel/laravel learnlaravel5 5.2.31</div></pre></td></tr></table></figure></p>
<p>项目创建完成，进入刚刚创建的项目，并使用PHP内置server服务启动项目，访问页面验证。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd learnlaravel5/public</div><div class="line">php -S 0.0.0.0:1024</div></pre></td></tr></table></figure>
<p>页面效果<br><img src="/images/15011226008351.jpg" alt=""><br>使用1024端口访问的目的是Unix系统的动态端口的开始端口，不需要进行端口配置，就可以启动监听。<br>如果单纯要学习Laravel或者PHP，请不要使用apache或者nginx这样的web服务器启动项目，对学习本身带来影响。</p>
<h2 id="启用Laravel针对PHP5-4版本的trait特性实现用户注册登录的功能，实现简单的用户权限管理"><a href="#启用Laravel针对PHP5-4版本的trait特性实现用户注册登录的功能，实现简单的用户权限管理" class="headerlink" title="启用Laravel针对PHP5.4版本的trait特性实现用户注册登录的功能，实现简单的用户权限管理"></a>启用Laravel针对PHP5.4版本的trait特性实现用户注册登录的功能，实现简单的用户权限管理</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd .. ##cd ~/workspace/learnlaravel5</div><div class="line">php artisan make:auth</div></pre></td></tr></table></figure>
<p>不需要停止php -S即可直接访问localhost:1024/login查看生成登录页面<br><img src="/images/15011235293792.jpg" alt=""></p>
<h2 id="Mysql创建数据库laravel5，用户名和密码均为root"><a href="#Mysql创建数据库laravel5，用户名和密码均为root" class="headerlink" title="Mysql创建数据库laravel5，用户名和密码均为root"></a>Mysql创建数据库laravel5，用户名和密码均为root</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">create database laravel5</div></pre></td></tr></table></figure>
<h2 id="修改learnlaravel5项目的配置文件"><a href="#修改learnlaravel5项目的配置文件" class="headerlink" title="修改learnlaravel5项目的配置文件"></a>修改learnlaravel5项目的配置文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd ~/workspace/learnlaravel5</div><div class="line">open .env ##.env文件不存在，需要拷贝一份.env.example</div></pre></td></tr></table></figure>
<p>修改配置项</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">DB_CONNECTION=mysql</div><div class="line">DB_HOST=127.0.0.1</div><div class="line">DB_PORT=3306</div><div class="line">DB_DATABASE=laravel5</div><div class="line">DB_USERNAME=root</div><div class="line">DB_PASSWORD=root</div></pre></td></tr></table></figure>
<h2 id="使用laravel默认的数据库描述文件创建表"><a href="#使用laravel默认的数据库描述文件创建表" class="headerlink" title="使用laravel默认的数据库描述文件创建表"></a>使用laravel默认的数据库描述文件创建表</h2><p>执行命令创建表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">php artisan migrate</div></pre></td></tr></table></figure>
<p>migrate命令要执行的php描述文件是learnlaravel5/database/migrations下的文件</p>
<ul>
<li>2014_10_12_000000_create_users_table.php</li>
<li>2014_10_12_100000_create_password_resets_table.php<br>再查看一下laravel5数据库中是否创建了这两个描述文件中的表，如果已经创建，说明命令执行成功，就可以用注册页面注册用户了，赶快试一试。<h2 id="使用-Laravel-的“葵花宝典”：Eloquent"><a href="#使用-Laravel-的“葵花宝典”：Eloquent" class="headerlink" title="使用 Laravel 的“葵花宝典”：Eloquent"></a>使用 Laravel 的“葵花宝典”：Eloquent</h2>Eloquent是Laravel定义的Model基类，只要Larave创建Model就会继承Eloquent类，此时创建的Model就具有了十个异常强大的函数，从此想干啥事儿都是一行代码就搞定，创建一个Article的Model体验一下：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">php artisan make:model Article</div></pre></td></tr></table></figure>
<p>创建Article对应的数据库描述文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">php artisan make:migration create_article_table</div></pre></td></tr></table></figure>
<p>打开刚刚创建的数据库迁移描述文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">open learnlaravel5/database/migration/*_create_article_table.php</div></pre></td></tr></table></figure>
<p>修改文件的内容为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line"></div><div class="line">use Illuminate\Database\Schema\Blueprint;</div><div class="line">use Illuminate\Database\Migrations\Migration;</div><div class="line"></div><div class="line">class CreateArticleTable extends Migration</div><div class="line">&#123;</div><div class="line">    /**</div><div class="line">     * Run the migrations.</div><div class="line">     *</div><div class="line">     * 创建文章表</div><div class="line">     *</div><div class="line">     * @return void</div><div class="line">     */</div><div class="line">    public function up()</div><div class="line">    &#123;</div><div class="line">        Schema::create(&apos;articles&apos;, function($table)</div><div class="line">        &#123;</div><div class="line">            $table-&gt;increments(&apos;id&apos;);</div><div class="line">            $table-&gt;string(&apos;title&apos;);</div><div class="line">            $table-&gt;text(&apos;body&apos;)-&gt;nullable();</div><div class="line">            $table-&gt;integer(&apos;user_id&apos;);</div><div class="line">            $table-&gt;timestamps();</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * Reverse the migrations.</div><div class="line">     *</div><div class="line">     * @return void</div><div class="line">     */</div><div class="line">    public function down()</div><div class="line">    &#123;</div><div class="line">        //</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>再次使用数据库迁移命令创建articles表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">php artisan migrate</div></pre></td></tr></table></figure>
<p>执行完后，在laravel5的数据库中会创建出articles的表结构。<br>使用Seeder往数据库中插入默认数据。首先创建一个Seeder，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">php artisan make:seeder ArticleSeeder</div></pre></td></tr></table></figure>
<p>在learnlaravel5/database/seeds/下打开并修改刚刚创建的ArticleSeeder.php文件，默认的run函数体为空，为其添加创建Article的数据脚本。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">public function run()</div><div class="line">    &#123;</div><div class="line">        DB::table(&apos;articles&apos;)-&gt;delete();</div><div class="line">        for ($i=0;$i&lt;10;$i++)&#123;</div><div class="line">            \App\Article::create([</div><div class="line">                &apos;title&apos;=&gt;&apos;Title&apos;.$i,</div><div class="line">                &apos;body&apos;=&gt;&apos;Body&apos;.$i,</div><div class="line">                &apos;user_id&apos;=&gt;1</div><div class="line">            ]);</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>把ArticleSeeder注册到项目的数据库执行环境中。打开learnlaravel5/database/seeds/DatabaseSeeder.php，并修改run函数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">public function run()</div><div class="line">    &#123;</div><div class="line">         $this-&gt;call(ArticleSeeder::class);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>由于learnlaravel5/database目录不能被composer自动加载，所有需要执行命令让这个目录加载待composer环境，保证代码能找到ArticleSeedr这个类。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">composer dump-autoload</div></pre></td></tr></table></figure>
<p>然后再执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">php artisan db:seed</div></pre></td></tr></table></figure>
<p>执行完，此时在数据库laravel5的article表中会产生10条数据。</p>
<p>下一节再讲解如何展示插入的数据 &gt;&gt;&gt;<a href="http://www.forwardlee.com/2017/08/01/Laravel5.x%E8%BF%9B%E9%98%B6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/">Laravel 5.x进阶笔记（二）</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;默认条件&quot;&gt;&lt;a href=&quot;#默认条件&quot; class=&quot;headerlink&quot; title=&quot;默认条件&quot;&gt;&lt;/a&gt;默认条件&lt;/h2&gt;&lt;p&gt;MacOS，&amp;gt;=PHP5.4，翻墙环境（默认创建的项目会请求*.google.com）&lt;br&gt;懂得PHP基础知识和MV
    
    </summary>
    
    
      <category term="PHP" scheme="http://www.forwardlee.com/tags/PHP/"/>
    
      <category term="Laravel5" scheme="http://www.forwardlee.com/tags/Laravel5/"/>
    
  </entry>
  
</feed>
